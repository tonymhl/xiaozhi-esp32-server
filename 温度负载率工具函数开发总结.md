# get_temperature_load_rate å·¥å…·å‡½æ•°å¼€å‘æ€»ç»“

## âœ… ä»»åŠ¡å®Œæˆæƒ…å†µ

å·²æˆåŠŸå°† `get_temperature_humidity`ï¼ˆæ¸©åº¦æ¹¿åº¦ï¼‰å·¥å…·å‡½æ•°æ”¹é€ ä¸º `get_temperature_load_rate`ï¼ˆæ¸©åº¦è´Ÿè½½ç‡ï¼‰å·¥å…·å‡½æ•°ã€‚

## ğŸ”„ ä¸»è¦å˜æ›´å†…å®¹

### 1. å‚æ•°æ›¿æ¢

| åŸå‚æ•° | æ–°å‚æ•° | è¯´æ˜ |
|--------|--------|------|
| `humidity` | `load_rate` | ç¬¬äºŒä¸ªå‚æ•°åç§° |
| `æ¹¿åº¦` | `è´Ÿè½½ç‡` | ä¸­æ–‡æè¿° |
| `humidity_value` | `load_rate_value` | å˜é‡å |
| `humidity_formatted` | `load_rate_formatted` | æ ¼å¼åŒ–å˜é‡å |
| `humidity_raw` | `load_rate_raw` | åŸå§‹å€¼å˜é‡å |
| `temp_humidity_setting` | `temp_load_rate_setting` | çŠ¶æ€å­˜å‚¨å¯¹è±¡å |

### 2. å‡½æ•°å’Œæ–‡ä»¶é‡å‘½å

| åŸåç§° | æ–°åç§° |
|--------|--------|
| `get_temperature_humidity` | `get_temperature_load_rate` |
| `get_temperature_humidity.py` | `get_temperature_load_rate.py` |
| `test_get_temperature_humidity.py` | `test_get_temperature_load_rate.py` |
| `parse_humidity()` | `parse_load_rate()` |
| `validate_humidity()` | `validate_load_rate()` |
| `initialize_temp_humidity_state()` | `initialize_temp_load_rate_state()` |
| `clear_temp_humidity_state()` | `clear_temp_load_rate_state()` |

### 3. æè¿°æ–‡æœ¬æ›´æ–°

æ‰€æœ‰å‡½æ•°æè¿°ã€æ—¥å¿—ä¿¡æ¯ã€ç”¨æˆ·æç¤ºä¸­çš„"æ¹¿åº¦"å‡å·²æ›¿æ¢ä¸º"è´Ÿè½½ç‡"ï¼š
- å‡½æ•°æè¿°ï¼š`GET_TEMPERATURE_HUMIDITY_FUNCTION_DESC` â†’ `GET_TEMPERATURE_LOAD_RATE_FUNCTION_DESC`
- æç¤ºè¯­ï¼š`"è¯·å‘Šè¯‰æˆ‘æ¹¿åº¦å€¼"` â†’ `"è¯·å‘Šè¯‰æˆ‘è´Ÿè½½ç‡å€¼"`
- æ—¥å¿—ï¼š`"æ¹¿åº¦å·²æ›´æ–°"` â†’ `"è´Ÿè½½ç‡å·²æ›´æ–°"`

## ğŸ“¦ äº¤ä»˜å†…å®¹

### 1. æ ¸å¿ƒä»£ç æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|---------|------|------|
| `main/xiaozhi-server/plugins_func/functions/get_temperature_load_rate.py` | ä¸»å‡½æ•°å®ç°ï¼ˆ279è¡Œï¼‰ | âœ… å·²å®Œæˆ |
| `main/xiaozhi-server/plugins_func/functions/test_get_temperature_load_rate.py` | å•å…ƒæµ‹è¯•æ–‡ä»¶ï¼ˆ306è¡Œï¼‰ | âœ… å·²å®Œæˆ |

### 2. éªŒè¯è„šæœ¬

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|---------|------|------|
| `main/xiaozhi-server/verify_temperature_load_rate.py` | éªŒè¯è„šæœ¬ | âœ… å·²å®Œæˆ |

### 3. æ–‡æ¡£

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ | çŠ¶æ€ |
|---------|------|------|
| `docs/get_temperature_load_rate_README.md` | ä½¿ç”¨è¯´æ˜æ–‡æ¡£ | âœ… å·²å®Œæˆ |
| `æ¸©åº¦è´Ÿè½½ç‡å·¥å…·å‡½æ•°å¼€å‘æ€»ç»“.md` | æœ¬æ–‡ä»¶ï¼ˆæ€»ç»“ï¼‰ | âœ… å·²å®Œæˆ |

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### ä¿æŒä¸å˜çš„ç‰¹æ€§
- âœ… å¤šè½®å¯¹è¯äº¤äº’
- âœ… æ™ºèƒ½å‚æ•°æå–
- âœ… å‚æ•°èŒƒå›´éªŒè¯
- âœ… ç¡®è®¤æœºåˆ¶
- âœ… ä¿®æ”¹åŠŸèƒ½
- âœ… å–æ¶ˆåŠŸèƒ½
- âœ… çŠ¶æ€ç®¡ç†
- âœ… é”™è¯¯å¤„ç†
- âœ… æ—¥å¿—è®°å½•

### æ›´æ–°çš„å‚æ•°
- âœ… ç¬¬ä¸€å‚æ•°ï¼šæ¸©åº¦ï¼ˆ-10â„ƒ~50â„ƒï¼‰
- âœ… ç¬¬äºŒå‚æ•°ï¼šè´Ÿè½½ç‡ï¼ˆ0%~100%ï¼‰ â† åŸä¸ºæ¹¿åº¦

## ğŸ§ª éªŒè¯ç»“æœ

```
======================================================================
éªŒè¯æ€»ç»“
======================================================================
è¯­æ³•æ£€æŸ¥                 âœ… é€šè¿‡
ç»“æ„æ£€æŸ¥                 âœ… é€šè¿‡
æµ‹è¯•æ–‡ä»¶è¯­æ³•               âœ… é€šè¿‡
æµ‹è¯•æ–‡ä»¶ç»“æ„               âœ… é€šè¿‡
======================================================================

æ€»è®¡: 4/4 æ£€æŸ¥é€šè¿‡ (100.0%)

ğŸ‰ æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼ä»£ç ç»“æ„æ­£ç¡®ã€‚
```

### Linter æ£€æŸ¥
- âœ… æ—  linter é”™è¯¯
- âœ… ä»£ç æ ¼å¼æ­£ç¡®
- âœ… å¯¼å…¥è¯­å¥å®Œæ•´

## ğŸ“‹ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ç”¨æ³•

```python
# ç”¨æˆ·å¯¹è¯ç¤ºä¾‹
ç”¨æˆ·: "è®¾ç½®æ¸©åº¦22åº¦è´Ÿè½½ç‡60%"
ç³»ç»Ÿ: "æ¸©åº¦ä¸º22â„ƒï¼Œè´Ÿè½½ç‡ä¸º60%ï¼Œè¯·ç¡®è®¤æ˜¯å¦æ­£ç¡®ï¼Ÿ"
ç”¨æˆ·: "ç¡®è®¤"
ç³»ç»Ÿ: {"temperature": "22â„ƒ", "load_rate": "60%", "confirm": true}
```

### è¿”å›æ ¼å¼

```json
{
    "temperature": "22â„ƒ",
    "load_rate": "60%",
    "confirm": true
}
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å‚æ•°è§£æ

```python
# æ¸©åº¦è§£æï¼ˆä¿æŒä¸å˜ï¼‰
parse_temperature("22åº¦") â†’ (22.0, "22.0â„ƒ")

# è´Ÿè½½ç‡è§£æï¼ˆæ›¿ä»£æ¹¿åº¦ï¼‰
parse_load_rate("60%") â†’ (60.0, "60%")
parse_load_rate("60") â†’ (60.0, "60%")
parse_load_rate("0.6") â†’ (60.0, "60%")
```

### å‚æ•°éªŒè¯

```python
# æ¸©åº¦éªŒè¯ï¼ˆä¿æŒä¸å˜ï¼‰
validate_temperature(22.0) â†’ (True, None)
validate_temperature(100.0) â†’ (False, "æ¸©åº¦100â„ƒè¶…å‡ºåˆç†èŒƒå›´...")

# è´Ÿè½½ç‡éªŒè¯ï¼ˆæ›¿ä»£æ¹¿åº¦ï¼‰
validate_load_rate(60.0) â†’ (True, None)
validate_load_rate(150.0) â†’ (False, "è´Ÿè½½ç‡150%è¶…å‡ºåˆç†èŒƒå›´...")
```

## ğŸš€ éƒ¨ç½²å’Œä½¿ç”¨

### 1. éªŒè¯å®‰è£…

```bash
cd main/xiaozhi-server
python verify_temperature_load_rate.py
```

### 2. å¯åŠ¨æœåŠ¡

æŒ‰ç…§é¡¹ç›®æ­£å¸¸æµç¨‹å¯åŠ¨ xiaozhi-server æœåŠ¡ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨åŠ è½½æ–°å‡½æ•°ã€‚

### 3. æŸ¥çœ‹æ—¥å¿—

å¯åŠ¨æ—¶åº”çœ‹åˆ°ï¼š
```
å‡½æ•° 'get_temperature_load_rate' å·²åŠ è½½ï¼Œå¯ä»¥æ³¨å†Œä½¿ç”¨
```

### 4. å¯¹è¯æµ‹è¯•

ä½¿ç”¨è§¦å‘è¯æµ‹è¯•ï¼š
- "è®¾ç½®æ¸©åº¦å’Œè´Ÿè½½ç‡"
- "è°ƒæ•´æ¸©åº¦è´Ÿè½½ç‡"
- "æ¸©åº¦22åº¦è´Ÿè½½ç‡60%"

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°é‡ |
|------|------|
| æ ¸å¿ƒä»£ç æ–‡ä»¶ | 2ä¸ª |
| ä»£ç æ€»è¡Œæ•° | 585è¡Œ |
| æµ‹è¯•ç”¨ä¾‹ | 20+ä¸ª |
| è¾…åŠ©å‡½æ•° | 6ä¸ª |
| éªŒè¯è„šæœ¬ | 1ä¸ª |
| æ–‡æ¡£æ–‡ä»¶ | 2ä¸ª |

## ğŸ” å®Œæ•´æ€§æ£€æŸ¥æ¸…å•

- [x] âœ… å‡½æ•°åç§°å·²æ›´æ–°
- [x] âœ… å‚æ•°åç§°å·²æ›´æ–°ï¼ˆhumidity â†’ load_rateï¼‰
- [x] âœ… å˜é‡åç§°å·²æ›´æ–°
- [x] âœ… å‡½æ•°æè¿°å·²æ›´æ–°
- [x] âœ… æ—¥å¿—ä¿¡æ¯å·²æ›´æ–°
- [x] âœ… ç”¨æˆ·æç¤ºè¯­å·²æ›´æ–°
- [x] âœ… çŠ¶æ€å­˜å‚¨å¯¹è±¡åå·²æ›´æ–°
- [x] âœ… æµ‹è¯•ç”¨ä¾‹å·²æ›´æ–°
- [x] âœ… æ–‡æ¡£å·²åˆ›å»º
- [x] âœ… éªŒè¯è„šæœ¬å·²åˆ›å»º
- [x] âœ… è¯­æ³•æ£€æŸ¥é€šè¿‡
- [x] âœ… ç»“æ„æ£€æŸ¥é€šè¿‡
- [x] âœ… æ—  linter é”™è¯¯

## âš™ï¸ å‚æ•°èŒƒå›´è¯´æ˜

### æ¸©åº¦å‚æ•°
- **èŒƒå›´**ï¼š-10â„ƒ ~ 50â„ƒ
- **åŸå› **ï¼šé€‚åˆç¯å¢ƒç›‘æµ‹å’Œè®¾å¤‡è¿è¡Œæ¸©åº¦
- **å¯ä¿®æ”¹**ï¼šåœ¨ `validate_temperature()` å‡½æ•°ä¸­è°ƒæ•´

### è´Ÿè½½ç‡å‚æ•°
- **èŒƒå›´**ï¼š0% ~ 100%
- **å«ä¹‰**ï¼šè®¾å¤‡å·¥ä½œè´Ÿè½½ç™¾åˆ†æ¯”
  - 0%ï¼šç©ºè½½/å¾…æœºçŠ¶æ€
  - 50%ï¼šåŠè½½è¿è¡Œ
  - 100%ï¼šæ»¡è½½è¿è¡Œ
- **å¯ä¿®æ”¹**ï¼šåœ¨ `validate_load_rate()` å‡½æ•°ä¸­è°ƒæ•´

## ğŸ”„ ä¸åŸå‡½æ•°çš„å¯¹æ¯”

### ç›¸åŒç‚¹
1. ä»£ç ç»“æ„å®Œå…¨ä¸€è‡´
2. å¤šè½®å¯¹è¯é€»è¾‘ä¿æŒä¸å˜
3. çŠ¶æ€ç®¡ç†æœºåˆ¶ç›¸åŒ
4. é”™è¯¯å¤„ç†æ–¹å¼ä¸€è‡´
5. æµ‹è¯•è¦†ç›–èŒƒå›´ç›¸åŒ

### ä¸åŒç‚¹
1. ç¬¬äºŒå‚æ•°ï¼šæ¹¿åº¦ â†’ è´Ÿè½½ç‡
2. å‚æ•°å«ä¹‰ï¼šç©ºæ°”æ¹¿åº¦ â†’ è®¾å¤‡è´Ÿè½½
3. è§¦å‘å…³é”®è¯ï¼šæ¸©æ¹¿åº¦ â†’ æ¸©åº¦è´Ÿè½½ç‡
4. çŠ¶æ€å¯¹è±¡åç§°ä¸åŒ

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### 1. å…±å­˜ä½¿ç”¨
ä¸¤ä¸ªå‡½æ•°å¯ä»¥åŒæ—¶å­˜åœ¨ï¼ŒLLMä¼šæ ¹æ®å…³é”®è¯é€‰æ‹©ï¼š
- "æ¹¿åº¦" â†’ è°ƒç”¨ `get_temperature_humidity`
- "è´Ÿè½½ç‡" â†’ è°ƒç”¨ `get_temperature_load_rate`

### 2. é€‰æ‹©æ€§ä¿ç•™
å¦‚æœåªéœ€è¦è´Ÿè½½ç‡ç‰ˆæœ¬ï¼Œå¯ä»¥ï¼š
- ä¿ç•™ `get_temperature_load_rate.py`
- åˆ é™¤æˆ–å¤‡ä»½ `get_temperature_humidity.py`

### 3. æ‰©å±•å»ºè®®
å¯ä»¥è¿›ä¸€æ­¥æ‰©å±•ï¼š
- æ·»åŠ æ›´å¤šå‚æ•°ï¼ˆå¦‚é£é€Ÿã€åŠŸç‡ç­‰ï¼‰
- æ”¯æŒæ‰¹é‡è®¾ç½®
- æ·»åŠ å†å²è®°å½•åŠŸèƒ½

## ğŸ‰ æ€»ç»“

âœ… **æˆåŠŸå®Œæˆ**ï¼šä»æ¸©åº¦æ¹¿åº¦å·¥å…·å‡½æ•°æ”¹é€ ä¸ºæ¸©åº¦è´Ÿè½½ç‡å·¥å…·å‡½æ•°  
âœ… **å…¨å±€æ›¿æ¢**ï¼šæ‰€æœ‰ç›¸å…³çš„å˜é‡åã€å‡½æ•°åã€æè¿°å‡å·²æ›´æ–°  
âœ… **ä»£ç å¥åº·**ï¼šé€šè¿‡è¯­æ³•æ£€æŸ¥ã€ç»“æ„æ£€æŸ¥ã€æ—  linter é”™è¯¯  
âœ… **åŠŸèƒ½å®Œæ•´**ï¼šä¿æŒåŸæœ‰æ‰€æœ‰åŠŸèƒ½ï¼Œä»…ä¿®æ”¹ç¬¬äºŒå‚æ•°  
âœ… **æµ‹è¯•è¦†ç›–**ï¼šå®Œæ•´çš„å•å…ƒæµ‹è¯•å’ŒéªŒè¯è„šæœ¬  
âœ… **æ–‡æ¡£é½å…¨**ï¼šä½¿ç”¨è¯´æ˜å’Œæ€»ç»“æ–‡æ¡£

**æ–°å‡½æ•°å·²å‡†å¤‡å¥½åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼**

---

## ğŸ”— å¿«é€Ÿé“¾æ¥

- [æŸ¥çœ‹ä¸»å‡½æ•°ä»£ç ](main/xiaozhi-server/plugins_func/functions/get_temperature_load_rate.py)
- [æŸ¥çœ‹æµ‹è¯•ä»£ç ](main/xiaozhi-server/plugins_func/functions/test_get_temperature_load_rate.py)
- [é˜…è¯»ä½¿ç”¨æ–‡æ¡£](docs/get_temperature_load_rate_README.md)
- [è¿è¡ŒéªŒè¯è„šæœ¬](main/xiaozhi-server/verify_temperature_load_rate.py)

---

**å¼€å‘å®Œæˆæ—¶é—´**ï¼š2024-10-09  
**ç‰ˆæœ¬**ï¼šv1.0.0  
**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆå¹¶éªŒè¯é€šè¿‡  
**æ”¹é€ è‡ª**ï¼šget_temperature_humidity v1.0.0  
**é¡¹ç›®**ï¼šxiaozhi-esp32-server

